(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{3446:(e,t,s)=>{Promise.resolve().then(s.bind(s,9839))},9839:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var l=s(5155),r=s(2115),a=s(8173),n=s.n(a),i=s(6046),o=s(1110);function c(){let e=(0,i.useRouter)(),[t,a]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(""),[x,h]=(0,r.useState)([]),[f,b]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[j,v]=(0,r.useState)(!1),[y,N]=(0,r.useState)({});(0,r.useEffect)(()=>{let e=localStorage.getItem("customPrograms");e&&N(JSON.parse(e))},[]);let w=e=>e.replace(/[A-Za-z]+/g,e=>e.split("").reverse().join("")),S=async e=>{if(y[e])return y[e];let t={"UX/UI":"تصميم الواجهات وتجربة المستخدم IU/XU","Excel & Power-Bi":"تحليل البيانات بإستخدام IB-rewoP & lecxE","Frontend Development":"تطوير مواقع الويب repoleveD dne-tnorF","Power-Bi":"تحليل البيانات بإستخدام IB-rewoP","Game Dev":"تطوير الالعاب باستخدام ytinU","3D Design":"التصميم ثلاثي الابعاد للالعاب"};return t[e]?t[e]:(b(e),v(!0),new Promise(t=>{let s=setInterval(()=>{y[e]&&(clearInterval(s),t(y[e]))},100)}))},k=async e=>{d(!0);try{let t=await P(e),l=[];if(e.name.endsWith(".csv"))l=(await s.e(159).then(s.t.bind(s,9159,23))).parse(t,{header:!0}).data;else if(e.name.endsWith(".xlsx")){let e=await Promise.all([s.e(524),s.e(436)]).then(s.bind(s,7660)),r=e.read(t,{type:"binary"}),a=r.SheetNames[0],n=r.Sheets[a];l=e.utils.sheet_to_json(n)}let r=["Program","Name AR","Gender","Email"].filter(e=>!l[0]||!Object.keys(l[0]).includes(e));if(r.length>0)u("الملف لا يحتوي على الأعمدة المطلوبة: ".concat(r.join(", "))),h([]);else{let e=[];for(let t of l){let s=t.Program,l=await S(s);e.push({trainee_name:t["Name AR"],email:t.Email,trainee_program:l})}h(e),localStorage.setItem("traineesData",JSON.stringify(e))}}catch(e){console.error("Error parsing file:",e),u("حدث خطأ أثناء تحليل الملف: ".concat(e.message))}finally{d(!1)}},P=e=>new Promise((t,s)=>{let l=new FileReader;l.onload=e=>{var l;(null===(l=e.target)||void 0===l?void 0:l.result)?t(e.target.result):s(Error("فشل في قراءة الملف"))},l.onerror=()=>{s(Error("فشل في قراءة الملف"))},e.name.endsWith(".csv")?l.readAsText(e):l.readAsBinaryString(e)});return(0,l.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("header",{className:"mb-8",children:[(0,l.jsx)(n(),{href:"/",className:"text-primary hover:underline mb-4 inline-block",children:"← العودة إلى الصفحة الرئيسية"}),(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"رفع ملف البيانات"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"رفع ملف CSV أو XLSX"}),(0,l.jsx)("p",{className:"mb-4",children:"يرجى رفع ملف يحتوي على الأعمدة التالية: Program, Name AR, Gender, Email"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("input",{type:"file",accept:".csv,.xlsx",onChange:e=>{var t,s;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!l)return;let r=null===(s=l.name.split(".").pop())||void 0===s?void 0:s.toLowerCase();if("csv"!==r&&"xlsx"!==r){u("يرجى رفع ملف بصيغة CSV أو XLSX فقط"),a(null);return}a(l),u(""),k(l)},className:"block w-full text-gray-700 bg-white rounded-lg border border-gray-300 cursor-pointer focus:outline-none p-2"}),m&&(0,l.jsx)("div",{className:"mt-2 text-red-600 text-sm",children:m})]}),c&&(0,l.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,l.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"}),(0,l.jsx)("span",{className:"mr-2",children:"جاري تحليل الملف..."})]}),(0,l.jsx)("button",{onClick:()=>v(!0),children:"فتح المودال"}),(0,l.jsxs)(o.lG,{open:j,onClose:()=>v(!1),className:"relative z-50",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),(0,l.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,l.jsxs)(o.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,l.jsx)(o.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"إدخال اسم البرنامج"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["البرنامج الجديد: ",f]})}),(0,l.jsx)("input",{type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"أدخل الاسم المعروض (سيتم عكس الكلمات الإنجليزية تلقائيًا)",className:"w-full p-2 border rounded mb-4"}),(0,l.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,l.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:()=>{let e=w(g),t={...y,[f]:e};N(t),localStorage.setItem("customPrograms",JSON.stringify(t)),v(!1),p("")},children:"حفظ"}),(0,l.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 focus-visible:ring-offset-2",onClick:()=>v(!1),children:"إلغاء"})]})]})})})]}),x.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-2",children:"معاينة البيانات"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"table w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{children:Object.keys(x[0]).map(e=>(0,l.jsx)("th",{children:e},e))})}),(0,l.jsx)("tbody",{children:x.map((e,t)=>(0,l.jsx)("tr",{children:Object.values(e).map((e,t)=>(0,l.jsx)("td",{children:e},t))},t))})]})}),(0,l.jsx)("div",{className:"mt-6 flex justify-end",children:(0,l.jsx)("button",{onClick:()=>{x.length>0&&e.push("/generate")},className:"btn-primary",children:"متابعة إلى إنشاء الشهادات"})})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[173,483,441,517,358],()=>t(3446)),_N_E=e.O()}]);