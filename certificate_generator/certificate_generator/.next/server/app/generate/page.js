(()=>{var e={};e.id=456,e.ids=[456],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9021:e=>{"use strict";e.exports=require("fs")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},6922:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c});var a=r(260),s=r(8203),l=r(5155),n=r.n(l),i=r(7292),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let c=["",{children:["generate",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4799)),"C:\\Users\\tagrb\\Documents\\cece\\cert\\certificate_generator\\certificate_generator\\src\\app\\generate\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,1354)),"C:\\Users\\tagrb\\Documents\\cece\\cert\\certificate_generator\\certificate_generator\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\tagrb\\Documents\\cece\\cert\\certificate_generator\\certificate_generator\\src\\app\\generate\\page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/generate/page",pathname:"/generate",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},322:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3219,23)),Promise.resolve().then(r.t.bind(r,4863,23)),Promise.resolve().then(r.t.bind(r,5155,23)),Promise.resolve().then(r.t.bind(r,802,23)),Promise.resolve().then(r.t.bind(r,9350,23)),Promise.resolve().then(r.t.bind(r,8530,23)),Promise.resolve().then(r.t.bind(r,8921,23))},8474:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6959,23)),Promise.resolve().then(r.t.bind(r,3875,23)),Promise.resolve().then(r.t.bind(r,8903,23)),Promise.resolve().then(r.t.bind(r,7174,23)),Promise.resolve().then(r.t.bind(r,4178,23)),Promise.resolve().then(r.t.bind(r,7190,23)),Promise.resolve().then(r.t.bind(r,1365,23))},8396:(e,t,r)=>{Promise.resolve().then(r.bind(r,4799))},5244:(e,t,r)=>{Promise.resolve().then(r.bind(r,6984))},6128:(e,t,r)=>{Promise.resolve().then(r.bind(r,1354))},5856:(e,t,r)=>{Promise.resolve().then(r.bind(r,9246))},9334:(e,t,r)=>{"use strict";var a=r(8686);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},6984:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5512),s=r(8009),l=r(8531),n=r.n(l),i=r(9334);function o({certificate:e,onDownload:t,onSendEmail:r}){return e?(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"معاينة الشهادة"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:t,className:"btn-primary",children:"تنزيل الشهادة"}),(0,a.jsx)("button",{onClick:r,className:"btn-secondary",children:"إرسال بالبريد الإلكتروني"})]})]}),(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"تفاصيل الشهادة:"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"الاسم:"})," ",e.trainee.trainee_name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"البريد الإلكتروني:"})," ",e.trainee.email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"البرنامج التدريبي:"})," ",e.trainee.trainee_program]})]}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",style:{height:"600px"},children:(0,a.jsx)("iframe",{src:(()=>{if(!e)return"";let t=new Blob([e.pdfBytes],{type:"application/pdf"});return URL.createObjectURL(t)})(),width:"100%",height:"100%",style:{border:"none"},title:"معاينة الشهادة"})})]}):(0,a.jsx)("div",{className:"card flex items-center justify-center min-h-[500px]",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"لم يتم اختيار أي شهادة للمعاينة"})})})}function c(){let e=(0,i.useRouter)(),[t,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)([]),[m,h]=(0,s.useState)([]),[u,p]=(0,s.useState)(null),[f,x]=(0,s.useState)(""),[b,g]=(0,s.useState)(null),[v,j]=(0,s.useState)("/template.pdf"),[y,N]=(0,s.useState)(""),[w,_]=(0,s.useState)("2025"),[P,C]=(0,s.useState)(!1),U=async()=>{if(0===c.length){x("لا توجد بيانات متدربين لإنشاء الشهادات");return}l(!0),x("");try{let{PDFDocument:e,rgb:t}=await r.e(857).then(r.bind(r,7857)),a=await r.e(589).then(r.bind(r,589)),s=[];for(let r=0;r<c.length;r++){let l=c[r];try{let n=await fetch(v).then(e=>e.arrayBuffer()),i=await e.load(n);i.registerFontkit(a);let o=await fetch("/fonts/shamel_bold.ttf").then(e=>e.arrayBuffer()),c=await fetch("/fonts/shamel_light.ttf").then(e=>e.arrayBuffer()),d=await i.embedFont(o);await i.embedFont(c);let m=i.getPages()[0],{width:h,height:u}=m.getSize(),p=(e,t,r)=>{let a=t.widthOfTextAtSize(e,r);return(h-a)/2};m.drawText(l.trainee_name,{x:p(l.trainee_name,d,30),y:u-350,size:30,font:d,color:t(.62,.45,.78)});let f=l.trainee_program;f=f.replace(/\)XU\/IU\(/g,"(UX/UI)"),m.drawText(f,{x:p(f,d,30),y:u-510,size:30,font:d,color:t(.77,.67,.86)}),P&&(y&&m.drawText(y,{x:h-100,y:u-100,size:20,font:d,color:t(.3,.3,.3)}),w&&m.drawText(w,{x:80,y:u-100,size:20,font:d,color:t(.3,.3,.3)}));let x=await i.save();s.push({id:r+1,trainee:l,pdfBytes:x})}catch(e){console.error(`Error generating certificate for ${l.trainee_name}:`,e)}}h(s),s.length>0&&p(s[0].id)}catch(e){console.error("Error generating certificates:",e),x(`حدث خطأ أثناء إنشاء الشهادات: ${e.message}`)}finally{l(!1)}};return(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)(n(),{href:"/upload",className:"text-primary hover:underline mb-4 inline-block",children:"← العودة إلى صفحة رفع الملفات"}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"إنشاء الشهادات"})]}),f&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:f}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"الإعدادات"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"قالب الشهادة"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("button",{onClick:()=>{g(null),j("/template.pdf"),h([]),p(null)},className:"btn-secondary text-sm mr-2",disabled:!b,children:"استخدام القالب الافتراضي"}),b&&(0,a.jsxs)("span",{className:"text-sm text-green-600",children:["تم رفع: ",b.name]})]}),(0,a.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{let t=e.target.files?.[0];if(t){if("application/pdf"!==t.type){x("يرجى رفع ملف PDF فقط");return}g(t),j(URL.createObjectURL(t)),h([]),p(null)}},className:"block w-full text-gray-700 bg-white rounded-lg border border-gray-300 cursor-pointer focus:outline-none p-2"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"show-date-fields",checked:P,onChange:()=>{C(!P),P||(h([]),p(null))},className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"show-date-fields",className:"text-sm font-medium",children:"إضافة حقول التاريخ (اختياري)"})]}),P&&(0,a.jsxs)("div",{className:"mt-2 bg-gray-50 p-3 rounded",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"الشهر (يظهر في أعلى اليمين)"}),(0,a.jsx)("select",{className:"input-field",value:y,onChange:e=>{N(e.target.value),h([]),p(null)},children:[{value:"",label:"بدون شهر"},{value:"JAN",label:"JAN - يناير"},{value:"FEB",label:"FEB - فبراير"},{value:"MAR",label:"MAR - مارس"},{value:"APR",label:"APR - أبريل"},{value:"MAY",label:"MAY - مايو"},{value:"JUN",label:"JUN - يونيو"},{value:"JUL",label:"JUL - يوليو"},{value:"AUG",label:"AUG - أغسطس"},{value:"SEP",label:"SEP - سبتمبر"},{value:"OCT",label:"OCT - أكتوبر"},{value:"NOV",label:"NOV - نوفمبر"},{value:"DEC",label:"DEC - ديسمبر"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"السنة (تظهر في أعلى اليسار)"}),(0,a.jsx)("select",{className:"input-field",value:w,onChange:e=>{_(e.target.value),h([]),p(null)},children:[{value:"",label:"بدون سنة"},{value:"2025",label:"2025"},{value:"2026",label:"2026"},{value:"2027",label:"2027"},{value:"2028",label:"2028"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"الخط"}),(0,a.jsxs)("select",{className:"input-field",children:[(0,a.jsx)("option",{children:"شامل بولد"}),(0,a.jsx)("option",{children:"شامل لايت"})]})]}),(0,a.jsx)("button",{onClick:U,disabled:t||0===c.length,className:`btn-primary w-full ${t||0===c.length?"opacity-50 cursor-not-allowed":""}`,children:t?"جاري الإنشاء...":"إنشاء الشهادات"})]}),m.length>0&&(0,a.jsxs)("div",{className:"card mt-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["قائمة الشهادات (",m.length,")"]}),(0,a.jsx)("div",{className:"max-h-80 overflow-y-auto",children:(0,a.jsx)("ul",{className:"divide-y",children:m.map(e=>(0,a.jsxs)("li",{className:`py-2 px-2 cursor-pointer hover:bg-gray-50 ${u===e.id?"bg-primary-light bg-opacity-20 rounded":""}`,onClick:()=>p(e.id),children:[(0,a.jsx)("p",{className:"font-bold",children:e.trainee.trainee_name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.trainee.email})]},e.id))})})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[t?(0,a.jsx)("div",{className:"card flex items-center justify-center min-h-[500px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"جاري إنشاء الشهادات..."})]})}):(0,a.jsx)(o,{certificate:u&&m.find(e=>e.id===u)||null,onDownload:()=>{if(u){let e=m.find(e=>e.id===u);if(e){let t=new Blob([e.pdfBytes],{type:"application/pdf"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`${e.trainee.trainee_name.replace(/\s+/g,"_")}.pdf`,a.click(),URL.revokeObjectURL(r)}}},onSendEmail:()=>{e.push("/send")}}),m.length>0&&(0,a.jsxs)("div",{className:"card mt-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"إجراءات جماعية"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsx)("button",{onClick:()=>{if(m.length>0)for(let e of m){let t=new Blob([e.pdfBytes],{type:"application/pdf"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`${e.trainee.trainee_name.replace(/\s+/g,"_")}.pdf`,a.click(),URL.revokeObjectURL(r),setTimeout(()=>{},500)}},className:"btn-primary",children:"تنزيل جميع الشهادات"}),(0,a.jsx)(n(),{href:"/send",className:"btn-primary",children:"إرسال جميع الشهادات بالبريد الإلكتروني"})]})]})]})]})]})}},9246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5512),s=r(63),l=r.n(s),n=r(4369),i=r.n(n);function o({children:e}){return(0,a.jsxs)("html",{lang:"ar",dir:"rtl",children:[(0,a.jsxs)("head",{className:"jsx-4d4d1bd3e4d6714a",children:[(0,a.jsx)("title",{className:"jsx-4d4d1bd3e4d6714a",children:"مولد الشهادات"}),(0,a.jsx)("meta",{name:"description",content:"تطبيق لإنشاء وإرسال الشهادات",className:"jsx-4d4d1bd3e4d6714a"}),(0,a.jsx)(l(),{id:"4d4d1bd3e4d6714a",children:'@font-face{font-family:"Shamel Bold";src:url("/fonts/shamel_bold.ttf")format("truetype");font-weight:bold;font-style:normal}@font-face{font-family:"Shamel Light";src:url("/fonts/shamel_light.ttf")format("truetype");font-weight:normal;font-style:normal}body{font-family:"Shamel Light",sans-serif}h1,h2,h3,h4,h5,h6,strong{font-family:"Shamel Bold",sans-serif}'})]}),(0,a.jsx)("body",{className:i().className,children:e})]})}r(4263)},4799:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\tagrb\\\\Documents\\\\cece\\\\cert\\\\certificate_generator\\\\certificate_generator\\\\src\\\\app\\\\generate\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\tagrb\\Documents\\cece\\cert\\certificate_generator\\certificate_generator\\src\\app\\generate\\page.tsx","default")},1354:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\tagrb\\\\Documents\\\\cece\\\\cert\\\\certificate_generator\\\\certificate_generator\\\\src\\\\app\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\tagrb\\Documents\\cece\\cert\\certificate_generator\\certificate_generator\\src\\app\\layout.tsx","default")},440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(8077);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},4263:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,213,367],()=>r(6922));module.exports=a})();